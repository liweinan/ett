<% package ||= nil %>
<% form ||= nil %>
<%
   tag_id = -1
   if !package.blank?
     tag_id = package.product.id
   elsif !params[:product_id].blank?
     tag_id = Product.find_by_name(unescape_url(params[:product_id])).id
   end

   blank_label = Label.new
   blank_label.id = ''
   blank_label.name = '-'

   labels = []
   labels << blank_label
   labels << Label.find_all_can_select_by_product_id_in_global_scope(tag_id)
   labels = labels.flatten
%>
<% if form.blank? %>
    <% if package.blank? || package.label.blank? %>
        <%= select_tag('package[label_id]', options_from_collection_for_select(labels, :id, :name)) %>
    <% else %>
        <%= select_tag('package[label_id]', options_from_collection_for_select(labels, :id, :name, package.label.id)) %>
    <% end %>
<% else %>
    <%= form.collection_select :label_id, labels, :id, :name %>
<% end %>
