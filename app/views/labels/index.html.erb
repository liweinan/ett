<h2>
  <% if params[:product_id].blank? %>
      System internal label list
  <% else %>
      Listing labels of <%= unescape_url(params[:product_id]) %>
  <% end %>
</h2>
<div class='manage-tbl'>
  <table>
    <tr>
      <th>Id</th>
      <th>Name</th>
      <th>Tag</th>
      <th>Can Show</th>
      <th>Can Select</th>
      <th>Track Time</th>
      <th>Is Finish State</th>
      <th>CSS Style</th>
      <% if can_manage? %>
          <th>Operation</th>
      <% end %>
    </tr>
    <% @labels.each do |label| %>
        <tr>
          <td><%= label.id %></td>
          <td><%= h label.name %></td>
          <td>
            <% if is_global?(label) %>
                -
            <% else %>
                <%= h label.product.name %>
            <% end %>
          </td>
          <td>
            <%= label.can_show %>
          </td>
          <td>
            <%= label.can_select %>
          </td>
          <td>
            <%= label.is_track_time %>
          </td>
          <td>
            <%= label.is_finish_state %>
          </td>
          <td style="<%= label.style %>">
            Example
          </td>
          <% if can_manage? %>
              <td>
                <%= link_to 'Edit', :controller => :labels, :action => :edit, :id => escape_url(label.name), :product_id => escape_url(params[:product_id]) %>
              </td>
          <% end %>
        </tr>
    <% end %>
  </table>
</div>
<%= render :partial => 'layouts/sep' %>

<% if can_manage? %>
    <% if has_product? %>
        <%= link_to "New label of #{unescape_url(params[:product_id])}", :controller => :labels, :action => :new, :product_id => escape_url(params[:product_id]) %>
        <%= render :partial => 'layouts/sep_tiny' %>
        <%= link_to "Back to #{unescape_url(params[:product_id])}", :controller => :packages, :action => :index, :product_id => escape_url(params[:product_id]) %>

    <% else %>
        <%= link_to 'New label', new_label_path %>
    <% end %>
<% end %>